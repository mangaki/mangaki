{% extends "base.html" %}
{% load staticfiles %}

{% block title %}Liste des suggestions - Page {{ suggestions.number }} - Mangaki{% endblock %}

{% block body %}

<h1>Liste des suggestions</h1><br/>

<div class="row">
{% for suggestion in suggestions %}
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">
            <a href="{% url "fix-suggestion" suggestion.id %}">Suggestion #{{ suggestion.id }}</a>
        </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item"><strong>Problème :</strong> {{ suggestion.get_problem_display }}

        <li class="list-group-item"><strong>Envoyé par :</strong>
            <a href="{% url "profile" suggestion.user %}">
                {{ suggestion.user.username }}</a> <small>({{ suggestion.date }})</small>
        </li>

        <li class="list-group-item"><strong>Œuvre :</strong>
            <a href="{% url "work-detail" suggestion.work.category.slug suggestion.work.pk %}">
                {{ suggestion.work.title }}</a> <small>({{ suggestion.work.category }})</small>
        </li>

        {% if request.user.is_authenticated %}
        {% for evidence in suggestion.evidence_set.all %}
            {% if request.user == evidence.user %}
            <li class="list-group-item"><small>Vous avez
                {% if evidence.agrees %}
                <span style="color: green"><strong>approuvé</strong></span>
                {% else %}
                <span style="color: red"><strong>rejeté</strong></span>
                {% endif %}
                cette suggestion
                {% if evidence.needs_help %}
                et avez indiqué qu'il y a <strong>besoin d'un administrateur</strong>.
                {% endif %}
            </small></li>
            {% endif %}
        {% endfor %}
        {% endif %}
    </ul>
</div>
{% endfor %}
</div>

<div class="row">
    {% include "pagination.html" with page_obj=suggestions paginator=suggestions.paginator %}
</div>

{% endblock %}
